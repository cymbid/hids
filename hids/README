
# HIDS 간단 테스트 (inotify + YARA-X)

`air2server`에 `--yara-test` 옵션을 추가하면 inotify로 파일 변경을 감지하고 YARA-X로 스캔하는 간단한 테스트를 실행합니다.

## 사용 방법

1. 실행

	- `build/bin/air2server --yara-test`

2. 트리거 파일 생성

	- `/tmp/aids_watch` 디렉터리에 `malware` 또는 `ransom` 문자열이 포함된 파일을 생성/수정하면 매칭 로그가 출력됩니다.

## fanotify 테스트

`fanotify`는 root 권한 또는 `CAP_SYS_ADMIN`이 필요합니다.

1. 실행

	- `build/bin/air2server --fanotify-test`

2. 트리거 파일 생성

	- `/home/orchid/tool/a-ids/build` 아래에 `malware` 또는 `ransom` 문자열이 포함된 파일을 생성/수정하면 매칭 로그가 출력됩니다.

## 동작 요약

- 감시 디렉터리: `/tmp/aids_watch`
- 감시 이벤트: 생성/이동/닫기-쓰기
- 규칙: `malware` 또는 `ransom` 문자열 감지
- 테스트 종료: 약 10초 후 자동 종료

